C51 COMPILER V9.53.0.0   WAVEFORM_TWO                                                      01/08/2019 22:23:21 PAGE 1   


C51 COMPILER V9.53.0.0, COMPILATION OF MODULE WAVEFORM_TWO
OBJECT MODULE PLACED IN waveform_two.OBJ
COMPILER INVOKED BY: F:\keil\C51\BIN\C51.EXE waveform_two.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          #include<reg52.h>
   2          #define uchar unsigned char
   3          #define uint unsigned int
   4          uint flag = 1;
   5          //选择的参数:1.方波 2.锯齿波 3.正弦波 4.三角波
   6          uint triangle = 0;//三角波的变量
   7          uint sanjiaof = 0;
   8          uint f = 0;//三角波的标识
   9          sbit fangbo = P3^4;
  10          sbit juchi = P3^5;
  11          sbit zhengxian = P3^6;
  12          sbit sanjiao = P3^7;
  13          uchar code sin1[256]={//正弦波的函数数组,放进程序存储器中
  14          0x80,0x83,0x86,0x89,0x8D,0x90,0x93,0x96,
  15          0x99,0x9C,0x9F,0xA2,0xA5,0xA8,0xAB,0xAE,
  16          0xB1,0xB4,0xB7,0xBA,0xBC,0xBF,0xC2,0xC5,
  17          0xC7,0xCA,0xCC,0xCF,0xD1,0xD4,0xD6,0xD8,
  18          0xDA,0xDD,0xDF,0xE1,0xE3,0xE5,0xE7,0xE9,
  19          0xEA,0xEC,0xEE,0xEF,0xF1,0xF2,0xF4,0xF5,
  20          0xF6,0xF7,0xF8,0xF9,0xFA,0xFB,0xFC,0xFD,
  21          0xFD,0xFE,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
  22          0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFE,0xFD,
  23          0xFD,0xFC,0xFB,0xFA,0xF9,0xF8,0xF7,0xF6,
  24          0xF5,0xF4,0xF2,0xF1,0xEF,0xEE,0xEC,0xEA,
  25          0xE9,0xE7,0xE5,0xE3,0xE1,0xDE,0xDD,0xDA,
  26          0xD8,0xD6,0xD4,0xD1,0xCF,0xCC,0xCA,0xC7,
  27          0xC5,0xC2,0xBF,0xBC,0xBA,0xB7,0xB4,0xB1,
  28          0xAE,0xAB,0xA8,0xA5,0xA2,0x9F,0x9C,0x99,
  29          0x96,0x93,0x90,0x8D,0x89,0x86,0x83,0x80,
  30          0x80,0x7C,0x79,0x78,0x72,0x6F,0x6C,0x69,
  31          0x66,0x63,0x60,0x5D,0x5A,0x57,0x55,0x51,
  32          0x4E,0x4C,0x48,0x45,0x43,0x40,0x3D,0x3A,
  33          0x38,0x35,0x33,0x30,0x2E,0x2B,0x29,0x27,
  34          0x25,0x22,0x20,0x1E,0x1C,0x1A,0x18,0x16,
  35          0x15,0x13,0x11,0x10,0x0E,0x0D,0x0B,0x0A,
  36          0x09,0x08,0x07,0x06,0x05,0x04,0x03,0x02,
  37          0x02,0x01,0x00,0x00,0x00,0x00,0x00,0x00,
  38          0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x02,
  39          0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,
  40          0x0A,0x0B,0x0D,0x0E,0x10,0x11,0x13,0x15,
  41          0x16,0x18,0x1A,0x1C,0x1E,0x20,0x22,0x25,
  42          0x27,0x29,0x2B,0x2E,0x30,0x33,0x35,0x38,
  43          0x3A,0x3D,0x40,0x43,0x45,0x48,0x4C,0x4E,
  44          0x51,0x55,0x57,0x5A,0x5D,0x60,0x63,0x66,
  45          0x69,0x6C,0x6F,0x72,0x76,0x79,0x7C,0x80
  46          };
  47          uchar *p = sin1;//指向数组头的指针
  48          uchar *p1 = sin1+255;//指向数组尾的指针
  49          /*延时函数,时间为10ms * del
  50            输入:del
  51            输出:无*/
  52          void Delay(int del){
  53   1        int i,j;
  54   1        for(i = 0; i < del ;i++)
  55   1        for(j = 0; j < 5; j++);
C51 COMPILER V9.53.0.0   WAVEFORM_TWO                                                      01/08/2019 22:23:21 PAGE 2   

  56   1      }
  57          /*********************************************
  58          * 名称 : Outside_Init( )
  59          * 功能 : 外部中断0 初始化
  60          *********************************************/
  61          void Outside_Init(void)
  62          {
  63   1      IT0 = 1; // 负边沿触发
  64   1      }
  65          /*********************************************
  66          * Time0_Init( )
  67          * 定时器的初始化,11.0592MZ晶振,50ms
  68          *********************************************/
  69          void Time0_Init( ){
  70   1        TMOD = 0x01;
  71   1        TH0 = 0x4c;
  72   1        TL0 = 0x00;
  73   1        TR0 = 1;
  74   1      }
  75          /*********************************************
  76          * Time0_Int( )
  77          * 定时器中断,中断中实现Count加一
  78          *********************************************/
  79          void Time0_Int( ) interrupt 1{
  80   1        TH0 = 0xff;
  81   1        TL0 = 0xe0;
  82   1        if(flag == 1){//方波的产生函数
  83   2          P0=0x01;
  84   2          Delay(100);
  85   2          P0 = 0xff;
  86   2          Delay(100);
  87   2        }
  88   1        if(flag == 2){//锯齿波的产生函数
  89   2          P0 = sanjiaof;
  90   2          sanjiaof++;
  91   2          if(sanjiaof >= 0xff) sanjiaof = 0x00;
  92   2        }
  93   1        if(flag == 3){//正弦波的产生函数
  94   2          P0 = *p;
  95   2          p++;
  96   2          if(p>= p1)
  97   2            p = sin1;
  98   2        }
  99   1        if(flag == 4){
 100   2          if( f == 0) triangle++;
 101   2          if(triangle >= 0xff) f = 1;
 102   2          if( f == 1) triangle--;
 103   2          if(triangle <= 0x01) f = 0;
 104   2          P0=triangle;
 105   2        }
 106   1      }
 107          void main(){
 108   1        Time0_Init( );
 109   1        Outside_Init( );
 110   1        IE = 0x83;
 111   1        //while(1);//开定时器中断和外部中断
 112   1      while(1){
 113   2        while(flag == 0){//没有波形
 114   3        P0=0x00;
 115   3        Delay(1);
 116   3      }
 117   2      while(flag == 1){//方波
C51 COMPILER V9.53.0.0   WAVEFORM_TWO                                                      01/08/2019 22:23:21 PAGE 3   

 118   3        P0=0x01;
 119   3        Delay(1);
 120   3        P0 = 0xff;
 121   3        Delay(1);
 122   3      }
 123   2      while(flag == 2){//锯齿波
 124   3        P0 = sanjiaof;
 125   3        sanjiaof++;
 126   3        if(sanjiaof >= 0xff) sanjiaof = 0x00;
 127   3      }
 128   2      while(flag == 3){//正弦波
 129   3        P0 = *p;
 130   3        p++;
 131   3        if(p>= p1)
 132   3        p = sin1;
 133   3      }
 134   2      while(flag == 4){//三角波
 135   3        if( f == 0) triangle++;
 136   3        if(triangle >= 0xff) f = 1;
 137   3        if( f == 1) triangle--;
 138   3        if(triangle <= 0x01) f = 0;
 139   3        P0=triangle;
 140   3        Delay(1);
 141   3        }
 142   2      }
 143   1      }
 144          void Outside_Int(void) interrupt 0{
 145   1        if(fangbo == 0) flag = 1;
 146   1        if(juchi == 0) flag = 2;
 147   1        if(zhengxian == 0) flag = 3;
 148   1        if(sanjiao == 0) flag = 4;
 149   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    558    ----
   CONSTANT SIZE    =    256    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     14    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
